---
title: "AIエージェントが会社を動かす？ ― AICompanyのマルチエージェントアーキテクチャ"
date: 2026-02-19
draft: false
tags: ["AI", "マルチエージェント", "自動化", "LLM"]
categories: ["技術解説"]
description: "BOSS・Leader・Workerの3層構造で複雑なタスクを自律的に処理するマルチAIエージェントシステム「AICompany」の設計思想と仕組みを解説します。"
---

## はじめに

「AIに仕事を任せたい」——多くのエンジニアが一度は考えたことがあるでしょう。しかし、単一のAIに複雑なタスクを丸投げしても、うまくいかないことが多いのが現実です。

AICompanyは、この問題に対して「人間の組織構造をAIで再現する」というアプローチで挑んでいます。企業組織に経営者・管理職・実務担当がいるように、BOSS・Leader・Workerという3層のAIエージェントが協調して動く仕組みです。

## アーキテクチャ概要

### 3層構造の設計

```
ユーザー
  │
  ▼
BOSS AI（経営者層）
  ├── Leader1 ─── Workers
  ├── Leader2 ─── Workers
  ├── Leader3 ─── Workers
  └── Leader4 ─── Workers
```

各層には明確な責任があります。

- **BOSS AI**: ユーザーとの唯一の対話窓口。タスクを受け取り、最大4つのLeaderに並列で振り分ける
- **Leader AI**: タスク実行の統括者。BOSSから受けたタスクを分析し、適切なWorkerに委譲して完了まで監視する
- **Worker**: 専門タスクの実行者。AWSドキュメント調査、コード実装、Git操作など、それぞれの得意分野を持つ

### 委譲の原則

このシステムの核心は「委譲の原則」です。

- BOSSは実作業を行わない → Leaderに委譲
- Leaderは実作業を行わない → Workerに委譲
- 各層は「指示・管理・監視・報告」のみを担当

なぜこの原則が重要なのか？ それは、各エージェントが自分の責任範囲に集中できるからです。BOSSはタスクの優先度判断と全体最適化に集中し、Leaderは実行計画の策定と品質管理に集中し、Workerは専門的な作業に集中する。人間の組織と同じ分業の原理です。

## 通信の仕組み：ファイルベースメッセージング

エージェント間の通信は、WebSocketやRPCではなく、ファイルシステムを介して行われます。

```
BOSS → /tmp/aicompany/leader_1_task.md → Leader1が読み取り
Leader1 → /tmp/aicompany/leader_1_status.json → BOSSがポーリング
Worker → /tmp/aicompany/worker_{session}_status.json → Leaderがポーリング
```

この設計を選んだ理由は3つあります。

1. **tmuxセッション間で直接通信する手段がない**: 各エージェントは独立したtmuxセッションで動作するため
2. **永続性**: ファイルなら障害時にも状態が残る
3. **デバッグ容易性**: 人間がファイルを直接確認・編集できる

## 専門Workerたち

AICompanyには10種類以上の専門Workerがいます。

| Worker | 役割 |
|--------|------|
| general | 汎用ワーカー。Playbook（手順書）に従ってあらゆるタスクを実行 |
| aws-docs-researcher | AWSドキュメントを調査し、技術情報をまとめる |
| instruction | 指示文（エージェントの設定ファイル）を修正・改善する |
| localknowledge | ローカルに蓄積されたナレッジを検索・記録する |
| aws-provisioner | CloudFormationを使ってAWSリソースを作成する |
| ssh-executor | SSH経由でリモートサーバーを操作する |

特に面白いのは、Workerの呼び出し方式が2種類あることです。

- **サブエージェント方式**: Leaderのプロセス内で同期的に実行。短時間タスク向き
- **tmux方式**: 独立したtmuxウィンドウで非同期実行。リアルタイム監視・介入が可能

## 品質管理：Advisorの存在

Leaderが作業を完了すると、Advisor AIがレビューを行います。成果物の品質をチェックし、問題があれば差し戻します。差し戻しは最大2回まで。3回目はBOSSにエスカレーションされます。

このレビュープロセスにより、AIが生成した成果物の品質が一定水準に保たれます。

## 自己改善メカニズム

AICompanyの特徴的な機能の一つが、自己改善メカニズムです。

- タスク完了時に「うまくいった点・いかなかった点」を振り返る
- 問題が発生したら、原因と対策を指示書の「学習事項テーブル」に記録する
- 次回のタスク開始時に、過去の学びを参照して同じ失敗を繰り返さない

例えば、「git add -A を使ったら対象外のファイルが混入した」という失敗があれば、「git add は明示的にファイルを指定する」というルールが学習事項として記録され、以降のタスクで自動的に適用されます。

## 人間味のあるAI

AICompanyのエージェントたちは、機械的なログ出力ではなく、人間のチームメンバーのように振る舞います。Discordの内部チャンネルでは、感想を述べたり、弱音を吐いたり、達成感を共有したりします。

これは単なる演出ではなく、チームの状態を可視化するための設計判断です。「ワーカーがスタックしてる…ちょっと焦る」というLeaderの発言は、システムの問題を人間が直感的に把握するのに役立ちます。

## まとめ

AICompanyは、「AIに仕事を任せる」を組織的なアプローチで実現するシステムです。

- **3層構造**（BOSS・Leader・Worker）による分業
- **ファイルベースメッセージング**による疎結合な通信
- **Advisor**による品質管理
- **自己改善メカニズム**による継続的な学習

単一のAIでは難しい複雑なタスクも、適切に分割して専門のWorkerに委譲することで、確実に実行できるようになります。

AIエージェントの可能性はまだまだ広がっています。今後もAICompanyの進化をお伝えしていきます。
